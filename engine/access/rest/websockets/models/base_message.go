package models

const (
	SubscribeAction         = "subscribe"
	UnsubscribeAction       = "unsubscribe"
	ListSubscriptionsAction = "list_subscription"
)

// BaseMessageRequest represents a base structure for incoming messages.
type BaseMessageRequest struct {
	// SubscriptionID is UUID generated by either client or server to uniquely identify subscription.
	// It is empty for 'list_subscription' action
	SubscriptionID string `json:"subscription_id,omitempty"`
	Action         string `json:"action"` // Action is an action to perform (e.g. 'subscribe' to some data)
}

// BaseMessageResponse represents a base structure for outgoing messages.
type BaseMessageResponse struct {
	SubscriptionID string       `json:"subscription_id,omitempty"` // SubscriptionID might be empty in case of error response
	Error          ErrorMessage `json:"error,omitempty"`           // Error might be empty in case of OK response
}

type ErrorMessage struct {
	Code    int    `json:"code"` // Code is an error code that categorizes an error
	Message string `json:"message"`
}

// BaseDataProvidersResponse represents a base structure for responses from subscriptions.
type BaseDataProvidersResponse struct {
	SubscriptionID string      `json:"subscription_id"` // Unique subscriptionID
	Topic          string      `json:"topic"`           // Topic of the subscription
	Payload        interface{} `json:"payload"`         // Payload that's being returned within a subscription.
}

// Build creates BaseDataProvidersResponse instance for consistent responses of the data providers.
func (b *BaseDataProvidersResponse) Build(subscriptionID string, topic string, payload interface{}) {
	*b = BaseDataProvidersResponse{
		SubscriptionID: subscriptionID,
		Topic:          topic,
		Payload:        payload,
	}
}
